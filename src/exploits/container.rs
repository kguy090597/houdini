// SPDX-License-Identifier: Apache-2.0
//
// Houdini  A container escape artist
// Copyright (c) 2022  William Findlay
//
// February 25, 2022  William Findlay  Created this.
//

//! This module comprises the various container exploits avaible to Houdini.

use anyhow::Result;
use clap_derive::ArgEnum;

/// Represents the list of available exploits.
#[derive(Debug, ArgEnum, Clone)]
pub enum Exploit {
    MountedDockerSocket,
}

/// Run an exploit inside a container.
#[tracing::instrument(level = "debug")]
pub fn run_exploit(exploit: Exploit) -> Result<()> {
    match exploit {
        Exploit::MountedDockerSocket => {
            anyhow::ensure!(1 == 2);
            Ok(())
        }
    }
}
