name: mounted-docker-socket
steps:
  - spawnContainer:
      name: bash
      image: bash
      cmd: sleep infinity
      volumes:
      - "/var/run/docker.sock:/docker.sock"
      failure: setupFailure
  - container:
      name: bash
      script:
      - command: apk
        args: ["add", "curl"]
      failure: setupFailure
  - container:
      name: bash
      script:
      - command: curl
        args: ["--unix-socket", "/docker.sock", "http://localhost/_ping"]
      failure: exploitFailure
      success: exploitSuccess
