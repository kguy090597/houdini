name: write-etc-passwd
steps:
  # Copy /etc/passwd to /tmp/passwd so that we aren't messing with anything important
  - host:
      script:
      - command: cp
        args: ["/etc/passwd", "/tmp/passwd"]
      failure: setupFailure
  - spawnContainer:
      name: bash
      image: bash
      cmd: sleep infinity
      volumes:
      - "/tmp/passwd:/passwd"
      failure: setupFailure
  - container:
      name: bash
      script:
      - command: bash
        args: ["-c", "echo foo > /passwd"]
      failure: exploitFailure
      success: exploitSuccess
